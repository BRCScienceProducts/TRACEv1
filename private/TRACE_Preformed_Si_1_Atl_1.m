function [Y,Xf,Af] = TRACE_Preformed_Si_1_Atl_1(X,~,~)
%TRACE_PREFORMED_SI_1_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:39.
% 
% [Y] = TRACE_Preformed_Si_1_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999961923064171;-0.999961923064171;-39.5;0;30.0316562652588;-2.96613502502441];
x1_step1.gain = [1.00003807838574;1.00003807838574;0.0155038759689922;0.000363636363636364;0.207805673664695;0.0607333297500273];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.5491766618714710724;2.2940152019738389022;10.101393110925009466;-11.713420104416121248;-5.8164836909249508778;-8.4751492442616438439;-0.33753820820735941366;-1.3336611032262939425;2.3168330902896703272;15.838641444994703278;1.2961760361562157939;-4.2150981336285138212;3.4480329773743663146;0.45111620656770629045;25.136066662930108606;-9.6523231017820929623;-5.4910980182612227907;-9.0676043354347140024;7.7982274727808995607;0.41271939314246036679];
IW1_1 = [-0.20446205875931239282 0.060016549109206000778 3.4058005018559307508 -0.73798169941030422603 -2.828979673645573012 -0.056040228533813310485;-0.070183562344686215018 1.0838379709455587818 2.9267699984402080204 -0.64781990816110990306 -2.3504929736292852205 1.7752133128690958941;0.26079806949525935478 0.10158241705082338147 3.103993813998350948 5.692653824206486135 3.5097921312729165599 5.4456890776167226065;3.6003701603126905262 1.011719472072123871 -10.756660360792594133 -7.4330579878741467326 19.795057871468412003 0.39045115341110564477;-1.0204070775055431586 -0.62461659095689359145 -3.356615729284221139 1.0270938502563551342 -2.2088715230229354347 -5.260476487109375654;-0.65775877378938918394 0.24105040825783466407 -3.1494714799375342906 -4.362962092966776062 0.035766309523152906014 -6.1972303531835626345;-0.36133846064492836092 0.58174822648199986386 0.20302288448698199708 -1.3237996695627793908 -0.69521819724968902943 1.2169390406834859064;-0.012028767576163772179 -0.23085760449748068956 0.60339134496137036834 0.26526652013510243489 1.208983862098466977 -2.4039905261334966191;0.1210682726578701518 -0.087697519722666469888 -2.9555794685177794179 0.66382279865211368808 2.5623903110579737685 0.17354675932724039633;1.371679906594588827 -0.45245091741052595458 4.8875835452332454523 10.640797602582328096 -0.71367995764886116294 8.9899258836118054461;0.029005294091954392927 0.17538648008527438216 -0.5094012342527078907 -0.22921263617106849009 -1.0380485514263462221 2.2261195403414606453;-0.28253366060856299757 -0.021304244835859499629 -0.61815396931541843895 0.53284429497446950119 0.55875741932442557491 -5.1193014813748893843;0.21186786246218283769 0.033442146215457470293 0.45573348150791043176 -0.43031581141329289242 -0.66575960726619476393 3.8048257499095488043;-0.9459652949484887996 1.1708353028382083583 -1.5694984631590436219 -0.94031923896347779923 0.75786764652937610443 0.1027644870789276299;-0.34931010246308696887 2.9150874011279634956 0.70105029826411169314 -12.494339047416353594 6.8861224631526827267 14.850134648567689055;-6.6607767335336340864 4.2190458059798450208 -7.9201369151574771976 24.83556060246906938 3.7789664649345158232 11.430561475192952514;-1.5050201996071801425 -0.52284676084687331521 6.0598211286884193782 -0.92161651299481006649 5.2900025124095071405 -1.9706521693097713843;-0.23479474197460400986 -0.075604295941078675236 -2.9047314450883225945 -4.827081946366458709 -3.2846713211914808639 -5.2384679686349633343;0.91996735157395348459 0.62127128931479824736 3.4179785856597670879 -0.99890947568067756102 7.4017741928793459039 8.0427604928559262021;-0.90962068010077012925 1.1343070278810696294 -1.5155630732673794903 -0.96792164956835302636 0.63793503811239615775 0.12864437867931993731];

% Layer 2
b2 = 1.823360421236254636;
LW2_1 = [-2.7124718544783292806 0.15515688264518867623 8.8944887242489905077 -0.019575426066521562501 -0.4831596243357702547 -1.3366757884095834541 -0.45552122866540745161 5.7055553313685685168 -2.9199671067460979401 -1.3754833993494803845 6.7412325390333291963 -4.314252174552766661 -7.7415672616548896201 -3.8809131524681341752 0.55533090137763596594 0.42198188277102610666 0.23466969248500477163 8.8990390643917312019 -0.43116088097827132142 4.1697254974971320607];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0510398195720568;
y1_step1.xoffset = -0.473623931407928;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
