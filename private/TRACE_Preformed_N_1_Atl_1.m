function [Y,Xf,Af] = TRACE_Preformed_N_1_Atl_1(X,~,~)
%TRACE_PREFORMED_N_1_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:39.
% 
% [Y] = TRACE_Preformed_N_1_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999961923064171;-0.999961923064171;-39.5;0;30.0316562652588;-2.96613502502441];
x1_step1.gain = [1.00003807838574;1.00003807838574;0.0155038759689922;0.000363636363636364;0.207805673664695;0.0607333297500273];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.2264765595839373091;-14.515076797876156789;-9.1199272729477378618;0.2431206803469851685;-0.28289148095778349212;-66.559022839869115273;-0.74281863665000769092;4.2068780621379824325;0.27883094348834575049;1.7278316130011734941;73.237346281717947249;0.2217690788984238992;0.062709914280232606498;-72.719280148984324796;3.9906065351768185145;-8.5235745432057257176;-0.97281249285232096469;4.9226988544754828325;9.6872278145846255626;6.4026329331960534219];
IW1_1 = [0.44109969437456830743 1.366736852622340237 1.1534412368241271363 -2.0411689081840171944 -5.4949664913041642578 -3.3524475850952475398;3.1328905174888701524 -4.4444697206221723818 6.7777258725884452772 -3.9751836139116591973 14.211365782885005515 -6.0390408112164228882;0.22289191053800155862 0.34803096320248616546 11.550167167294269177 1.4053724888082135269 -5.2811695396759006371 2.1114356117533459312;0.032851301837967243624 0.026062760811773430514 1.134821249474392113 0.81641703579792546108 -2.6906549344241952326 1.0106061692824466203;1.5976174009759045447 0.47710201146190184263 0.39843292426877602308 -0.99750779254984389688 1.7244273571944570556 1.7893541844752016701;0.91089611791971014654 0.098650098165534397254 2.4359441855703996005 -66.068133627744217051 -4.3177273679301375608 2.2383653998101911142;1.6030198008890217398 -0.83487381984528996615 -2.3575495614051047433 1.8485260984648659299 9.6710832043616665743 -3.9159747758617848845;0.48602029409787056435 0.043875250162553489086 1.1336782712637845094 1.621279261552986517 -2.6654174744103498185 4.2439818058124512135;-0.0035253999510664129312 0.041662620447815421065 1.0294639490187207365 0.75411328615203832015 -2.6185533257454260969 0.97783203396949969211;0.23466810901904530673 -0.35539800564887413792 1.4626379813796690499 1.673303223751487101 10.822492211920035743 -0.98408097949323702913;-14.675071286669719939 9.4566674494451543609 7.0762326794721177592 53.744217765057967995 -0.86325971929857026055 -0.025544607391802833657;-1.8223888718496052963 1.2048345139092557776 7.5466554280906104069 -2.681646045162305203 -4.625543238333730045 3.7996305608927918307;0.17610043894208218807 -0.40882060611599713162 1.399925375455393306 0.74644202395909009518 -0.32465757791847443814 -1.8359291350010646937;14.71711608579304631 -9.4827306340706485344 -7.236163130729874382 -52.980451076968549273 0.76952190655747443326 0.19954111621742398608;0.46853621965383074333 0.054527927926599731312 1.1223961780607234484 1.5679338152826143293 -2.4893597187357854317 3.9725577175520965234;-5.041318339120516967 2.5817888165538422918 -0.36511944111982852501 0.316849012909595662 -6.0762323904571857724 -4.5127801708692834026;-3.3629604735629277101 -2.5806859861200912576 0.075329476166611022969 1.2521798530058081411 -5.8885673117772112661 1.4981556628887415794;-0.26334449198945314441 0.14016088283413291604 1.2243668517148555974 -0.41829941401927045463 0.23016504509271715206 4.1794457319904774195;0.14267135949523035432 -0.14623498046407862327 -1.3858698067358219408 0.57794621363269516046 -11.303817367969575258 8.7703860501616333067;0.20254862670338474873 -0.14684094419907664508 0.47606447947175095647 6.3734528578814559907 6.9777292354020756804 -0.90302675479141847337];

% Layer 2
b2 = 0.70125056690544218529;
LW2_1 = [-0.11163159523017501806 0.057364085456642045779 -0.071351245001197383111 -8.0538435735728288734 0.17314814862594229972 -0.20102379119843791222 0.10645479136108426665 8.3645527166890811799 8.8707398674222162072 -0.37885563259991150709 -6.5270773730266435919 -0.082469741852649797176 0.36927180195944858676 -6.5332064239919489523 -8.8891697290563609357 -0.050029565665995152923 -0.076296997156289361741 -0.85215646663166300101 -0.35524808645256256145 0.60730779550768543285];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0686941773550495;
y1_step1.xoffset = -0.494993358850479;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
