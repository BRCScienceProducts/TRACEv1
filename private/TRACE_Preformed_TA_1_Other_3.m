function [Y,Xf,Af] = TRACE_Preformed_TA_1_Other_3(X,~,~)
%TRACE_PREFORMED_TA_1_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:40.
% 
% [Y] = TRACE_Preformed_TA_1_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999961923064171;-0.999961923064171;-77.5;0;30.1649227142334;-2.9811577796936];
x1_step1.gain = [1.00003807838574;1.00003807838574;0.0119760479041916;0.000363636363636364;0.22152510192902;0.0532708976942295];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.35228436460882756043;5.02968607160991521;0.16005605199481967582;-3.1092109695047871476;-0.22859902434040982322;1.0722046572455761204;-1.5667667446899107286;-3.4920134780417186882;-0.80963206028756851129;-1.0389669564060497464;1.5650261346367579929;1.1378734197371758174;-0.54088133374191948999;4.3456019149952549441;6.8255081697881987424];
IW1_1 = [-2.1776269260189087262 -0.38201006574198331789 -1.2253237835303729675 -3.2885033011701918504 1.6194280911581526716 1.0296704771573375048;0.10435311236879213359 0.085136725423602788165 -0.0041924052054373196763 -0.059070862013311187244 32.019718390314928058 6.815139098698910658;-0.51661757432412569457 -0.0099854848503987576891 -0.051016981216826927381 0.95890744687600637519 0.80109114322812791098 1.182663819912554759;-0.57947775777627896776 -0.12948817621764061037 0.0059543885104728789398 0.6222989232641017443 -5.3160941510621100292 -3.602269914353446012;-0.085706801480090050172 -0.11861257635558088153 2.6997885920402726612 1.5333312893719883707 -4.877599346685467907 -2.729373335268352907;0.050059696493061946188 0.054185576506704261068 -0.0040047984489770859298 0.035491681847390897653 -0.022241841207562760424 -0.091691848882193852099;-0.031417366009208587407 -0.049582770955857675965 -0.039991535230705289872 -0.05225786415676229868 -0.0040599412665239939177 0.032250439936220856585;-2.0263813134138444205 0.12792796210245774291 0.39412997233843161116 -2.1777723045475552155 0.84041416589100459422 -2.0766548122579591151;-0.067930682910627815385 -0.44656081759712290546 -0.15805766345337851631 -1.3112612772730147803 -0.30700834388779868478 -1.3318645622307494492;3.8856615001481760174 0.061426600282595236746 -2.1938257231178011075 0.05993381302670387073 -1.0363910045165170004 -3.6607738612140376944;0.18708831620633695203 0.44638658482211102108 0.39357591908024980309 0.88009102913516767952 -0.054672052645419126626 -0.059983463389492133744;-0.35104156237275480068 -0.35566495354599647616 -0.5174896021756238973 -0.49935222128366663075 -0.054143427641290244046 1.3830964075659997192;-0.04520646801040148488 -0.084258122108876620793 -0.10094210653291256496 -0.097990425014269674775 0.021118847758156821665 0.023837406975535123388;3.4803424261073074852 -0.51435101564756990911 -1.0639543866314349341 4.0171281284385438326 17.646275392034564078 1.234454603031552189;4.1368822707785479764 -1.1483756687067874225 -0.14290419427776990258 -11.174613637793905596 0.94266025119764529361 -8.4471760989104520689];

% Layer 2
b2 = [-180.95143011484384488;59.435517444075863125;-237.46936244527219628;368.37871660747777014;-39.516781016888451461];
LW2_1 = [15.329406375388026973 55.821914976544270814 127.77800878731180489 -196.0971285964203048 86.7600098330679117 334.5042569035825295 267.11243103022258083 2.2880278454346982819 219.7205359238400888 56.490006997526911903 64.913147845614375342 161.31472104052281225 399.85768572845626068 51.339607678786123302 -57.643473160499169694;-57.085131695928929219 -187.19378041507923172 -145.00678918234839898 -626.94131262891903589 16.133430284857727344 -30.818927533949317166 278.55653051867045633 101.58074457844561778 12.008767677280822284 -117.2288772926684004 -264.99703831993554104 8.4827117132236082853 -7.1635357948440825382 75.048748796396708372 118.87570596313263138;-0.25216273087327495395 -0.404233620573654584 2.1480286056195185829 0.30186937202222258181 0.20384516398470833853 -16.884900074061061304 -280.70826928131435807 -0.26690763131345229819 0.87752918472986130016 0.17887647318695940046 -3.4732831421514442916 2.1590114638026682847 7.5141031352973675084 -0.10516863562553990796 0.3308923036214778679;-0.30480638118813618842 -0.44562239459818769882 2.686281847125800315 0.26174030494558359061 0.20257188121484678844 39.431908662248538633 170.00170859049629257 -0.2863837141221880489 0.90252697277135218723 0.21866666761163508492 -3.4649473977881375397 2.531106951791559645 -32.819502524178290059 -0.11138295047801718973 -256.88330413882016501;32.363271248091464827 -6.3306854853734488842 -40.779617250943751117 -14.790271632924481437 -12.320450445041128518 25.935666454487179777 -195.22066033029992127 -8.0619707744661894822 70.093244752471377979 -84.392328500753691856 19.861449108116978834 -30.91821287265898377 -55.922837599175430512 -13.475288180277710026 -233.61985280902717932];

% Layer 3
b3 = -0.12905523717766867464;
LW3_2 = [-0.0021128544785422032071 0.0048422636624738816039 0.87176919133589247934 -0.75566660550069852942 -0.0033475057068624116709];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00351113753226865;
y1_step1.xoffset = 2059.216796875;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
