function [Y,Xf,Af] = TRACE_SFs_1_Atl_2(X,~,~)
%TRACE_SFS_1_ATL_2 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:41.
% 
% [Y] = TRACE_SFs_1_Atl_2(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999025224415;-0.999999995392661;-40;0;22.805;-1.9603];
x1_step1.gain = [1.00000064853082;1.09776974554843;0.0153861540000154;0.000332778702163062;0.134898151895319;0.0611727426493303];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.1066944866905967793;-2.0707177702498573701;-0.21585315881314831588;4.3042803229325539149;0.9330090195589818558;0.47308934466053054191;0.20804902054254159616;-0.018132252314457603798;-1.8204154107235330784;-1.6630531990725974101];
IW1_1 = [-0.5707900398479310855 -0.043378062688182075779 1.0368850452277120766 -0.86773500712628404141 0.60484749063051856943 0.97478979217142902591;0.47639891178449850218 0.51337127641958746338 -1.3681471369077498057 -0.54929382742519083926 -0.12918695597488130677 -1.7817128638663370932;1.1168908313103638186 -0.43975711311400184078 -3.5616898925447291191 1.5006697414093894682 2.4131180280723412146 -1.0664026710892180461;-0.62607576240633189268 -0.82310604731059178185 -2.6432521671500373017 -2.3205669276075711061 -0.011663549360486802353 4.3670179517983642725;0.67673435657227276607 1.9902623801103802581 -4.268981373791692846 -0.95044485183435956088 0.8015756806920195654 -1.4574613058806102917;-0.64708969758831846875 0.076426166219495647591 -0.73427763985305605221 1.6932650281707817275 0.45835128184418133523 -1.1257769502965990771;0.0031566134687586455687 -0.62558039497211259672 -0.071049231128747711295 0.55190762544844973458 0.25863788189500108716 2.1382703155462610134;1.0330134196347779962 -0.71114454727404652346 -1.4686849720168886346 0.67650646062882335841 1.1246767235356847081 -0.67088902337266032028;-1.1067652997892962752 -0.075653921564443088466 -0.28948936029475375031 1.6209979287047082686 -0.4723356135347577256 -0.78879606581110817132;-0.70096430133099585369 -0.62167306825449863972 -0.89453237337036606291 -0.46374719619930482306 -0.5590560167658111812 -1.2023747845643752985];

% Layer 2
b2 = [2.0269273826569436103;2.129389829819133606;1.6366564190030805648;-1.440592005839448575;-1.5637473224472082656;-0.88720652277371070404;-0.7102567401383617085;1.2758377192825132163;1.3777245211823907489;-1.5729797795921296455];
LW2_1 = [-0.8547020140193027915 -0.49667794583641577955 -1.0063506582096419795 -0.072017171458344630963 0.63980320900294795905 0.41327224597990547261 -0.19552680108862857677 0.0029983761559108819406 0.42772678106051209568 -0.13590108315027521479;-0.32256586573089135461 -2.2379028280008834706 3.9485406737172557001 -4.3032328341457368737 -2.3306026991835264717 1.1490743287982572163 -1.840695019831167567 -0.89509019663666022915 -1.1230841417773531621 -1.006259520849779987;-0.026406295961308470094 -0.011629822404816103978 -1.2572377155666145665 1.088575729825352445 -1.4184222534334887111 0.10520276405207466819 -1.2279134456009090925 0.40868637530497636812 -1.4845094026171661294 -0.74583630700243586098;0.11107961143949358906 1.1863028817214120725 -0.60508452845312166168 0.042990705694125753988 -0.16406528004436932155 -0.38755461498413196209 -0.40320957849502236936 -1.0067772590008692291 -0.3563792745157166042 0.10787614792906211059;0.42730208497565874692 0.77554289800162468094 0.63223335894643417632 -0.085606486960040306666 2.3816963185046926554 -0.34498343986255392002 0.063659592163089875894 -0.53601574215674196999 1.1338700213368355652 0.49496192161200758264;-0.29964936993924484732 -0.074680375729244394267 -0.98570205626941920229 -0.07102583465842617072 0.63760773487157518247 -0.19141584015667822971 0.40243164185236518504 1.7131798752265265939 0.3102620365240589817 0.85651475221254280701;-0.30721678266581325945 0.061468370197627970886 -0.63298260907138792497 -0.65621543807662696679 0.87667211922396948154 -0.62221990715459885024 -1.2324279155707560385 0.97121056436100583475 -0.089482380486197707348 -0.53066106906796084441;1.0578560219973218715 1.0270704906398899769 0.51533587456465901333 1.5766689001737208553 -1.8127278788366962825 1.3322114754989331509 0.85917497379130225443 -0.89946405434385556799 0.98296273039606252286 0.72835772823960953648;0.57317246793547860229 -0.48070813792088912253 0.56729133568610057292 0.25410445389047853215 -0.88962970089780979421 -0.27094485171266569079 0.092935983347354228501 -0.41352235739484144439 -0.23404815803000486585 -0.96726632511175048013;-0.039164895809462113574 0.33093580125755889254 0.58863325851890080376 -1.0663778262033387634 0.11169879636550188173 -0.44860245083924732423 -0.68107846734768695551 -0.17154444668086424319 0.87484893683659004093 0.51330168093790384809];

% Layer 3
b3 = -0.96440346416259647988;
LW3_2 = [1.3620937054191906146 0.55888336247223202591 0.25120836806761320803 -1.076677660906047107 1.3004089219994516835 -1.461078042487835793 -0.59459913111350604087 -0.33394285264041889683 -0.26424899406873986196 1.1614033110012911276];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.481947690293183;
y1_step1.xoffset = -2.9999223498254;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
