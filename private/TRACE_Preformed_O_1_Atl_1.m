function [Y,Xf,Af] = TRACE_Preformed_O_1_Atl_1(X,~,~)
%TRACE_PREFORMED_O_1_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:37.
% 
% [Y] = TRACE_Preformed_O_1_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999961923064171;-0.999961923064171;-39.5;0;30.0316562652588;-2.96613502502441];
x1_step1.gain = [1.00003807838574;1.00003807838574;0.0155038759689922;0.000363636363636364;0.207805673664695;0.0607333297500273];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.9333342241434854358;1.3092914270954865152;-1.9164877889063869354;65.506707946252262786;-4.9086078887630035794;-0.58916484568322380344;-3.6419804107967288509;0.04297793194564664826;0.92610480613289181129;-3.459534806639908755;0.19142727295230116402;-1.7376908573898672827;-1.3133555915592391994;27.021875757775042359;10.356732050307204673;0.010002175191263562581;-14.432680414730358009;-7.2382018325166290751;-19.861892530452109895;-63.609039783523151357];
IW1_1 = [0.33907207890926760463 0.069019690205416470152 1.9059269786545245395 4.6518292997845236414 3.4259193751359209301 1.1216742126152559056;0.2610025511008899346 -0.7869018293332655789 -1.8096196409518110482 1.7314188819008671238 -0.63201422085408465179 1.278769009831903336;1.0895277577449213879 1.2294971470963189653 -0.2261504905745969074 -1.2145552000610131405 3.07142654247129121 0.88319897745677344858;0.60535650675274599308 0.36979494980544125315 -9.0137388606313884054 64.497825212466352696 -0.75860705874700284923 -5.8888997826647697664;-0.29708605045239094844 -0.11688310487446935959 -1.8322677836562364373 -4.583980423360440426 -3.4499905943874620284 -1.0770780978878324863;0.91447836271418092569 0.79518799378947890855 -1.6976229776283418005 1.1269504673586845378 -0.20792470147133038094 -0.48484197567449893729;-0.042926804942428800627 -1.8688775487969266909 -1.9109617828429104058 3.9904363721850590885 5.6719707441391040703 -8.257129457107437176;0.73702044753350004491 -0.93378974652581625548 1.4742254588522292202 1.3371312631063256848 -0.7203493767778319512 0.71247092485142926588;0.1978737394102025593 -1.2391884633106353686 -2.79944693508551401 2.7293588989841905956 -0.89934086043442051928 -1.2638848566886116132;0.10351325158688497174 -0.98229074513576519756 1.7908293413985678644 0.24610027895580499635 -1.6042459624954856778 -4.1122856053073144622;0.054321880367176340887 1.5733127727653710703 4.7943235973032622965 -1.3791756105654706666 0.80622138416761279789 2.4913811386664361791;-14.353112312816087126 -2.5377568507753744953 -4.597437874017759718 1.2758634470586112108 -21.284630087497074413 -1.3180078462727085054;-0.15427678807040903775 0.62313338076519775299 1.6391233164116243426 -1.6038660000742981371 -0.26214666453909685195 -0.78089833521475204847;8.5750822303322937756 -1.9832631815265111541 9.3051673960427407906 29.180999240357579083 -0.97409442947797819645 -3.6641894169612325705;2.8836295115490493401 1.7604493461730219561 4.6162615796875767771 1.3974297675505571448 -14.292196709193257576 19.359125349437189101;0.75067394714960533619 -0.95466952668871607468 1.4834474238107435706 1.3738817314487234977 -0.69886213640669336833 0.67011041927647019278;-18.246321859512743657 -9.1791342406697715717 10.431983050956834091 -2.7803814466789940063 -2.3961701374916182239 -0.15709571005476083427;-0.077569092642708947771 0.4909176036794278275 -1.4903684526751654893 -7.8587711444306442843 -3.5501568184996523669 3.139591221711024005;0.21032372197160056904 -0.667896906656219147 -2.3629399577652887565 0.26774290880877560372 29.120585952775236649 -23.119816367913621491;-0.26328722716542085625 -0.13940659090311521839 -1.1263235154976063424 -62.069127003362574158 -1.2844809170004245491 -1.6303188826709500425];

% Layer 2
b2 = 0.37362556825960396845;
LW2_1 = [2.5479119013156839024 0.74089813093137746325 0.078272690748077564105 -0.078033162404172087823 2.5291106357663912796 0.059344955908972207848 0.031099464058043837372 -3.0394335043134046437 0.24765076576202077474 0.14066127681453549636 0.13625323530235813885 0.0087378207737682997425 0.94059920195661828046 -0.043338150783644335817 -0.014476644558000297328 2.9744920710965758737 -0.019910983254958682792 -0.15815197334365804771 -0.13094956571842383819 0.38341587406325761123];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00639021416728488;
y1_step1.xoffset = 136.002920238134;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
