function [Y,Xf,Af] = TRACE_SFs_1_Other_1(X,~,~)
%TRACE_SFS_1_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:41.
% 
% [Y] = TRACE_SFs_1_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999451688695;-0.999617390652097;-75.291;0;31.351;-1.9283];
x1_step1.gain = [1.00007734910688;1.00019210311383;0.014121999957634;0.0003147128245476;0.364192585038969;0.0607044754374516];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.3247354059342932864;1.7091132857330926242;2.6968961513115674578;-3.8295433985691147427;-0.44903577348262790903;-2.8654716136455862241;2.5863467249698928185;1.0530065878798569035;-0.48474162692917749373;-2.9861294961308235685;2.7699238793070879439;-3.5504294399090472467;-1.6073816510874308072;3.7209077166847501772;2.8478250207940312144;-2.5201330153773002785;-1.1857172296013909207;-1.1417387304138870707;0.76165449556797515385;5.9977680674637738889];
IW1_1 = [0.12556084684358695402 -0.016234741568163554848 0.18078205271904848606 -2.1493782906560978674 -1.9519312506352803904 3.013379748266991065;-1.6099236291040215363 -0.98244651072322874974 -0.12994385354895052198 1.04020523673512022 2.5319923880740091704 -2.6671121105476909285;-4.1044698223520095226 2.2538441883798889798 -2.9256916128335141991 -1.384799262382014895 1.5651119710838716781 -2.4486471078533873502;6.5267012967357702635 -5.1100104344933523493 5.8313044821299664378 -0.31994663600887063293 -2.1342126266301906234 2.4182708623091948574;-0.085143968216974230678 1.1834692976885381466 -0.45865661524081313694 0.20562500105184972066 0.17918830822268272396 1.4814877682039206963;-0.4813441287027466764 0.26730901342644269869 1.5572003345301452804 -1.058881511261117625 0.30549199523887493601 3.0812427358449219206;0.17213977992074644408 0.12289910779203855329 -1.3305708990256865931 -0.35740446171748813109 -2.905431464103708894 4.167251290612992598;-0.34791821527066607578 1.0752748395938602766 -2.4959721309233082742 0.21874280227244208286 -5.674143591669253972 2.7042475902676330612;2.8113861641287605231 0.65582044299281128108 0.43184400345537976573 1.6230383967004906598 0.97760572780170951201 -0.075449869193790083943;-0.13836875668805859174 0.23101659315043465703 -1.3695147739911037732 -1.5054374069853271312 1.6939174631325650822 0.88053269388153376784;0.37910907604870419663 0.55013430541018759623 -2.2778681376111094004 0.61912755408872255369 -0.1996866200947305936 -4.7985521524947891692;0.091941696539270409416 -0.65237609618504666109 -0.035991063204570059031 -4.2554898283143760551 -9.055166436059732149 0.053688692769811759142;-2.7035246171433158224 -0.75824458739901445803 -0.16365494165277219563 -0.91067714562512169785 1.3066923780880710382 -0.40225605109481404886;0.10995187905789774452 -0.97959800672275698652 -0.5985371907199049657 -2.4423767289209608045 -7.2018571757320115623 -2.5426588701161656481;0.19511598320308071175 0.072743101229123502405 -1.1707032130547541104 -0.14239301110311100573 -3.504290406207997588 4.3954113750914665104;-0.13858605581054880829 -0.39886075490777239683 2.094455903975672495 1.0670527245529872751 2.1038109588451194831 -4.3135253961608075457;-0.81373634521876492265 -0.57389141528082743271 -0.19824991253393792201 -0.63385755860163339737 0.72904311977500446673 -1.0605778221831854147;-0.94119016459867888003 -1.4527596825155026927 -0.33719047368110544038 -0.93743216755313996114 1.7623029229781619343 -0.63746698170099302949;0.12747076808846002915 0.93830813682331892789 -0.0029134822412483444426 -0.1290075043286511014 -1.0760545605837255057 3.495586633682019162;3.4981614758752082039 0.51860931203613347407 1.6231535794228679759 0.55645898687484485201 -4.434689264149439758 -0.84826455480444162838];

% Layer 2
b2 = 0.24102635192681998166;
LW2_1 = [0.17286208495309304811 -0.38018770910268528951 -1.3257374154117154141 -0.35947748040398241898 0.5590273121396752698 -1.3063380683452470166 2.2302257650293038083 -0.21979666769720179742 -0.29803915123223923 -0.90198507974229236162 -0.48805184906234300168 -0.19135272253952650967 0.34967790441332458062 -0.29855503117087212051 -2.1398222094969105989 0.34136855225821427506 -1.5913397257406414198 0.67430927061507273113 -0.58561050034938455511 -0.29065143913704893919];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.479723223512926;
y1_step1.xoffset = -2.9999223498254;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
