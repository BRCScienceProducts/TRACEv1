function [Y,Xf,Af] = TRACE_EstT_Temperature_1_Atl_1(X,~,~)
%TRACE_ESTT_TEMPERATURE_1_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:41.
% 
% [Y] = TRACE_EstT_Temperature_1_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 5xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999961923064171;-0.999961923064171;-39.5;0;30.0000762939453];
x1_step1.gain = [1.00003807838574;1.00003807838574;0.0155038759689922;0.000363636363636364;0.206927881437043];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.89084418677067056525;8.7972601018963505481;3.3273198737935247848;-0.34128787227628498702;0.093421460704781245088;-6.1249854204350588915;0.22372538680950090906;3.9930703952409931645;5.1718640237784105906;-3.9597971825261844003;0.18879015290262565752;0.90951721831094844983;0.97358665652858755735;-17.759052216508493416;2.3540907022867183507;3.2722560523402868249;-4.6461719860361201384;0.39198080300989907032;3.6051878871048379516;-18.211105766046976839];
IW1_1 = [-2.4831836020730042591 0.23648333784545114145 3.8884842662692959969 1.0579871425763915926 -7.0512988187837235543;-5.4888575765339782109 -2.0612352933883593131 -4.7364423744398207461 0.6171505483910665335 7.0640801512158821751;-2.0955886612244953859 -0.81122314350261848226 -1.0179343121418364948 1.0398986150977185261 -2.0336079965281093074;-0.50721212514201152732 -0.0079590058469478763142 1.7682953060360235842 0.48261065847881734481 0.59029736417476419419;0.19210138588845721008 -0.38006006380703655223 -0.98575256723985560381 0.59799514175245715997 2.2125297215156249919;-0.27180179168587342842 3.952137218282085751 15.436617181792886555 9.6769447901634038089 0.85563623097531027462;0.14364260182663346477 -0.9851060125215602703 1.0605834693792173251 1.9827164907907337543 0.55150138168408779915;0.52504517001069361815 -1.4824502684580507239 -4.4153338977779137409 7.5503908163025155176 -0.56270858644696641893;-4.3339853053344867817 6.3923087947953911581 -0.50150183209009424612 -1.2035832402571546851 -0.38801266789460842066;-0.52056970706935690174 1.4184743702540425492 4.3896492016859509633 -7.4075962652761093707 0.59272756539429216627;0.14527665213918009024 -0.44882105431241792193 -0.79080062136635842496 0.7302613239341274598 2.0777797210571984365;0.2636861402233592333 -0.78949759069009184387 -0.76941292885963963322 0.85055555078871891705 0.14372917658297229559;-0.2452867290676566947 -0.1243205114912641629 0.29200254521742852187 0.94627521723598340131 -2.3092214219400433173;0.18032234664227195231 -0.53348426809678173299 -1.7768956559557966823 -15.970338248999908615 -0.44472231881285073651;-0.034876523634975169219 0.15435241747202407825 0.51943177007804730572 2.1072589328114053053 5.2364390330212620128;-2.3734074207794653155 2.5257016735550386066 2.3196496884660393611 0.58309720284186494776 1.2987092673639719642;-0.93825681317265963166 0.52121266284458134255 1.0551578151132896544 -7.9816052502420218318 5.4605876254164273931;0.58562737184199153972 0.080685128481636420039 -1.9566409371979580634 -0.63874616930443095519 -0.63664187804191829656;1.2228207711052505591 -2.2908612813347568604 0.77190124284666206123 2.2158595962491833831 4.8561626100777388615;0.1194697863561735296 -0.48396644419103185264 -1.567216708649932011 -16.721280558765855062 -0.56166786988872785535];

% Layer 2
b2 = 0.052365471184375941838;
LW2_1 = [-0.23331815117660961723 -0.1091478541039068717 0.29061761876080993705 -7.7345569023760942784 -4.9641348591696035086 0.023414890397510393361 0.32485086114492073284 3.0944054691334113016 0.060021515527532903755 3.1584615701485261319 5.014413341499684762 -1.1222151686758630174 -1.168560653959232809 -9.0040294678751937596 -0.29655137094110034512 0.24731996140101542014 0.033132952801665317699 -6.4286350408924777255 0.10104409777937002624 9.0235956636931486941];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0596262898164022;
y1_step1.xoffset = -2.99982047080994;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
