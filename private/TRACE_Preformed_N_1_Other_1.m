function [Y,Xf,Af] = TRACE_Preformed_N_1_Other_1(X,~,~)
%TRACE_PREFORMED_N_1_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:40.
% 
% [Y] = TRACE_Preformed_N_1_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999961923064171;-0.999961923064171;-77.5;0;30.1649227142334;-2.9811577796936];
x1_step1.gain = [1.00003807838574;1.00003807838574;0.0119760479041916;0.000363636363636364;0.22152510192902;0.0532708976942295];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.5143547797038037217;-1.5189108862618969642;2.4964931978210831431;-53.34487893210899756;5.1664250761123922118;-1.7372974472327828988;6.0309233201342982156;1.4768130398784931057;-0.21346374042696877882;0.1456191544616163569;0.29431153211295263405;0.37344855127837389697;3.846028571464183532;-1.7520679383511967853;3.5402063831108838698;3.4298116015543027579;6.7908624731290201382;-5.1590511455545389197;1.3878909053991148603;0.44079432388874062454];
IW1_1 = [-0.47612228844161791352 0.066768427932292748195 -1.8578950277302295202 2.3326689703567309309 -2.6007372683821734505 0.30410011742164316795;0.13882172566182068851 -0.0063513286990911155608 0.35312329069179965169 -0.8161782424641507161 -1.0573753196757162964 -0.20487899586125887796;-0.47596377102711145968 0.011892685032604377593 -1.8285813265864119259 2.2807754191917695152 -2.7433500142673690192 0.33446942639124560559;6.930761968355127145 18.333551755078801193 6.6862827182991502184 -35.830660703359832553 4.5505803646075655422 1.9478299593314967186;-0.31844625484101640733 0.025230788613070893184 2.4902929525901038588 4.8291337219331467168 -1.4445210125732250717 0.17956200895763838044;-0.10930681191548746733 -0.093510026728480799552 -0.73414157058016715762 -0.59353716951135249147 -2.2112068092603927028 -1.3816661061202073491;8.6286079002404534322 2.9807400953723082182 6.7748775206079541178 12.091895432166975155 6.7446864235494876638 0.11274676207963303665;1.1503558761895085194 0.48096365045018524276 0.17842282076502180566 2.484852288326433456 3.1976324323232785396 -1.0062468848686274558;0.43341717570562665607 0.17730619486038226573 0.25797051594050457446 -1.0729315734750985989 1.0979529546734396739 1.145726677552884043;0.087340622003540535623 -0.038746382337811136054 0.85234266970001215658 0.60463700008443277412 -0.81401951186366905411 -0.57885550294910348423;-2.8872359804092533331 -3.0244216671993173762 3.283895674646132079 -0.12576556515697906447 10.239758063531091636 -1.9899659601640298234;-0.10613071915580152282 -0.34866185678829947348 0.52516680017577221928 0.48400020666952625614 1.9270341129339920716 0.42292272910361972116;-0.34196037446178773056 0.032081504466190673142 2.6014611901067508093 3.9526981923458457402 0.57770749460434678291 -1.219151603596193123;-1.4427378274998332586 0.68755216449450606842 1.1268337934672052469 1.0942983123877876306 -8.8298539801461490839 -3.5045102959895864103;0.50417363239549584097 -1.6176213299039972071 -0.40354935487211418543 5.3951837888720550751 -0.72114825127675941108 -3.1725415270551566849;1.0492165904974999346 -0.34620982520522941561 -2.8704798174558909807 0.80412886424136953423 -3.4992546692110884088 1.5970706919558637082;0.71879263030144535662 0.19242644876324752068 1.4266163142495242866 5.7647014174022919164 7.060500142297970072 -1.9631129768638742039;-3.9384901375640817278 -5.709614889525647996 -0.091864012598820168898 1.4953006644438577855 -1.9402824132916376421 0.228529757264631872;0.69435920930275396579 0.37408737475882303247 -0.24295898418103489824 2.4186687748821462662 -0.011506365384649953551 -0.4192422641282185225;1.721656646815840741 1.0636752039957630966 3.2831182504708755765 -1.5485146846569781687 -1.1251428454654328615 -0.1128126277036430869];

% Layer 2
b2 = -1.9939245017068649712;
LW2_1 = [-7.2318745714937948676 -4.0253019085518433329 7.4180086908664426559 0.14880554465364612127 0.48449722761650287906 1.8304513291210171566 0.027829763821568178489 0.47747844737687683558 1.3078504921018581086 2.0291514850146512572 0.0481111258639444761 -0.76090923221214923355 -0.4991827711408995949 0.091728002670236952198 -0.095577157065517226453 -0.26345972319543442541 0.25559513283668605643 0.032354024811910943316 -0.64196372767221632216 -0.13102205824488138974];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0553271360105305;
y1_step1.xoffset = -0.497560739517212;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
