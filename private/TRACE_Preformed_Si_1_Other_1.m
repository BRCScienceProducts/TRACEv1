function [Y,Xf,Af] = TRACE_Preformed_Si_1_Other_1(X,~,~)
%TRACE_PREFORMED_SI_1_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:39.
% 
% [Y] = TRACE_Preformed_Si_1_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999961923064171;-0.999961923064171;-77.5;0;30.1649227142334;-2.9811577796936];
x1_step1.gain = [1.00003807838574;1.00003807838574;0.0119760479041916;0.000363636363636364;0.22152510192902;0.0532708976942295];
x1_step1.ymin = -1;

% Layer 1
b1 = [48.040234068428610215;-2.7750826579431731034;21.46815012465545891;-12.615754601438862181;18.773112472303544962;-10.188200229804921904;-4.0334661044237982708;9.5378450420082678818;1.1211018236604630705;-1.2587875090178419768;-3.1455575622973070971;-3.6525619793373702571;0.056656080901187982901;0.010423353195536862528;-26.269276271830648284;-1.7954515155230847956;3.1375281622531345782;-4.1185698637409151601;1.7803914146905228666;6.6704590014650726459];
IW1_1 = [-0.39453607730450696023 -0.58033032234699144514 27.411028870178483885 16.162418389360102111 31.006519718067167446 12.825551677671573003;-11.145508110130904811 -4.7049779176070316566 -3.7099864117127641094 -9.7748168796906949041 -31.613080419618686534 0.97612674158572143579;-1.1740604451150520315 0.25919413255519035966 18.145361292396099628 3.6556752548550792703 10.173303787962487021 4.5973586683491918237;0.067366663913442911826 0.16037739971902958969 -3.5677546013900087729 -9.7615417164190958488 1.7937020495000490783 -12.267663123068455633;-0.45806830440091655943 -0.21738889683437159772 8.3910899708591397683 -0.94057863581838185851 5.0720219731002833541 15.424752242232074195;-3.0777722003553278363 -3.0552087041945137358 -3.0816051111824118713 -7.2898680722054640668 10.81676168039678565 -3.1574874894240374523;-0.89622749355331154941 4.8199300733742092007 -4.0131045443931494532 1.4465973024733562724 -11.187234032534730588 1.1660524542198558162;2.3402774330832483152 -2.1798664738185236089 5.9629926872859364551 -0.16536385719087612345 -1.763940863059228592 -1.1377284942925705025;0.36735215474452681539 -0.17295697323521322386 1.9480142352020206609 3.2491907448497880928 -4.3517843052538971449 -1.1852820703648356826;-0.34876686669717299472 0.16014080317599482806 -2.0052431811412949614 -3.3720901721322884548 4.2717496544228943378 1.0737134056181181219;-2.0701103141907393201 0.054589563698182110019 -0.94586212159976579272 0.30660773372117255953 -18.530174008281978359 -6.0335259938700005478;-2.5721424479165877486 0.18218824075989617506 1.5731681402656243485 1.2296590870347769986 10.578491791027104796 -5.3447272332409729856;0.049988759098279066106 0.16901730226086736364 -0.4860426230825125038 0.88555747397466000326 8.4660855844737099574 -0.81142329876289764901;0.054887773940453042643 0.1705246300598871334 -0.51981445692410099824 0.826691622055386377 8.4277946872224571706 -0.85346005520834133939;12.333958058062709284 -13.241017174447218707 -2.310443793359954423 -34.086684166585236255 9.2953795146443791708 28.036578719965273621;-0.72687522694925443822 -0.10770468858425688574 0.59627403266950462779 -0.54661075315457285928 1.5548972685665829463 -0.54832926843246554416;1.8641561976934066802 -0.17534261606788753562 -1.1018459666964235399 -1.1233949948208930003 -1.6487358156931963826 4.4149357583619046608;-1.0449668832257745787 0.94649006728502882435 -1.1199816533535795759 -3.6806079276071987927 -0.88934797880564497863 -2.2494879549908963767;0.71938389688871962058 0.10133231650441640315 -0.51626692916812244594 0.53668486465759479564 -1.4283721273133291874 0.51711977396488550962;-0.012740116211300793816 0.14145259859472283925 2.6824841178234617445 6.9955132266104032013 -6.1907568659625917817 3.6531544404226981015];

% Layer 2
b2 = 8.1072712485762075119;
LW2_1 = [-0.20283300647246341186 0.019290732891124855869 0.10450862491893327111 -0.083429891169280387397 -0.22133020340189871189 0.058835830228788389695 -0.047000636533969186726 -8.8874566502267384749 4.7521340315222113659 4.7748037953628754693 0.07717378015669452973 -0.29317165984790727329 -8.4886183302447459909 8.5917564756751403365 0.032132537386913059829 7.5230746582119136789 -0.42039039094753999359 0.10500228533807672016 7.9082568611568211381 0.16950861702122019259];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0184350799221364;
y1_step1.xoffset = -0.488903820514679;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
