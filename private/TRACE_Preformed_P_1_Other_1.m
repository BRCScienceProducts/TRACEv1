function [Y,Xf,Af] = TRACE_Preformed_P_1_Other_1(X,~,~)
%TRACE_PREFORMED_P_1_OTHER_1 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:38.
% 
% [Y] = TRACE_Preformed_P_1_Other_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999961923064171;-0.999961923064171;-77.5;0;30.1649227142334;-2.9811577796936];
x1_step1.gain = [1.00003807838574;1.00003807838574;0.0119760479041916;0.000363636363636364;0.22152510192902;0.0532708976942295];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.2079325694244724687;-39.540892561318784715;4.9679996560213481871;-74.223404388345215921;3.9201463377309333502;-0.077772940977619317571;0.50437254078995286122;-1.0570693049042350076;-1.0966625507969980369;0.19132859378118841076;0.88412367687270221328;-0.012532023021731040352;1.1072683786610990619;4.704728157243979858;6.6588565729610555977;1.553651762898366151;-0.51873990722290463928;1.1832330243923534496;0.23185838158643423679;1.9165026950137888928];
IW1_1 = [0.061824839220651656158 0.18504759008960841582 -1.0947722416886083163 0.89098226229712751412 2.9617605155318145194 -4.8716707776379877259;5.9438399619057378231 16.223624546426762549 6.8263318063305815642 -22.980549236129238722 6.2993224384611110622 -0.043357984264353555126;-0.2202753924140057884 -0.074245128645503088993 2.8356789459959030886 -2.1937574300690076967 -6.989754871007168191 3.2868531219432912671;0.87965436918230921481 -5.5683482940850018844e-05 -0.67890735466056384428 -74.420077513524475421 -10.208416211502925108 -0.32488083472193368673;-0.053847110977178175295 -0.18571861037995771038 1.0877395934001103939 -0.8344989166366715283 -2.9827182532239175927 4.4358981377189969919;0.066441314570149817564 0.072704530135807521329 -1.1297847910467699872 -0.56140566908224387443 1.0871793273784209344 0.31774107715971589005;0.12398632468544594498 0.088545944790971997662 -0.62743045026931287822 0.09266339208103607783 1.285937230299616596 0.56458002394414741332;0.78078086206051400264 -0.22707000551682529621 0.83487991369045766454 0.38332996678075753616 1.7394379399352650761 -0.18705172427230482013;-1.1002513254660726272 -0.48595267536769048977 0.79572038791310273353 -0.060241470159653850991 -3.0039736864987651721 0.94191974323471261421;-0.076380602048003842786 -0.079296985628175567506 1.3046942854615526386 0.67434590048100429005 -1.0013610630794600453 -0.23765713567197666034;-0.38264916453933001117 -0.16750053842967477236 0.87703904342708516317 0.61457914120231060817 5.1336765801533026377 0.10979003494459949053;-0.45726796152029319797 0.2746914238333741376 0.87118948626085512821 -0.90039828868094173853 1.3212586837372184423 -1.145031579519113496;0.0053204308754571782297 0.029924250200668800481 0.33487788728984435593 -0.064401714703982371191 0.57016164022772619635 0.66833291241266679084;-0.23189187680742578967 -0.072582628166680665527 3.0316602559155994001 -2.3349144670673092072 -6.7792258190142922203 2.7751166569518344041;1.5219436327279804999 1.4027681129865494647 5.0424515592143377418 1.4559931821132623408 -5.4007430281149835238 -1.850457140854982363;0.74673690934292002996 -0.74665765995101474051 0.69699710955805227464 0.53988389889225996132 1.1331975236750022606 0.84770799229156190702;0.13220485928971323353 0.26035842521089763713 -3.2859591248688002629 -1.8858177743934627646 2.1251643792936794064 -2.1367256671776790888;0.0014284536719636501886 0.030813898398944526008 0.51502466929962642528 -0.031182948275303993407 0.71165557782444166524 0.78175245616737876198;0.37503240751481731197 -0.4291371283244319601 -0.11272693647700243735 0.3904923813591238968 -0.5212327421103273295 0.35137643645599958564;0.45691612697355360462 -0.10354739834420283173 -0.58310626261692222183 0.74836077526059541221 -1.1734880931261695292 1.7550430565448615905];

% Layer 2
b2 = -5.7416780786970953443;
LW2_1 = [7.9035580858151526229 0.2146181232204834588 -5.8654612031236785796 -0.084471689708795094642 8.9378499955684134193 -21.408727921376186742 6.3744525497094155497 -0.93184410941986450805 0.40396891340120333336 -15.075076955694459713 -0.3913599253622651597 1.5719179927672577435 30.34051246609777408 5.1441247545973300959 0.19699217322971873667 -0.30941788240169254554 0.33954598373224254004 -23.522683383212044106 1.9515609927993635697 -1.755916661333693618];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.683263173544107;
y1_step1.xoffset = -0.138191044330597;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
