function [Y,Xf,Af] = TRACE_Preformed_N_1_Other_3(X,~,~)
%TRACE_PREFORMED_N_1_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:40.
% 
% [Y] = TRACE_Preformed_N_1_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999961923064171;-0.999961923064171;-77.5;0;30.1649227142334;-2.9811577796936];
x1_step1.gain = [1.00003807838574;1.00003807838574;0.0119760479041916;0.000363636363636364;0.22152510192902;0.0532708976942295];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.8145579440533623483;-3.5403947611864268197;-0.83885658147107722282;-1.6906997060076836004;-4.8175554916950407147;-0.00096917820514735842068;1.8994552945755249773;3.8229401900646688972;-0.051371467225779503252;-0.91299563770704650345;-2.9409042276023775742;-0.47443809889979227101;0.504144640233570418;3.4412323092441190475;-7.7789797397680446878];
IW1_1 = [0.51540344733940102184 0.079881236635335667318 -1.1658614555043449457 -6.5118557197793354163 -0.74936623925558454307 2.3604735116924615568;1.5045642682339290808 -0.25273251940836727325 0.31161883090675329688 -2.9816927309560727899 4.1537867421537066903 -0.19610547971468550443;-0.064803006980870145326 -0.021148561471402271134 -1.5585432854079455112 1.8431879018348082955 6.826603351492243732 -0.98574790218581742618;-0.059244119008645367008 -0.73567439275396029341 -0.31934961062995786962 -1.5899333064575282837 5.0615356080505788938 -1.2561200641222494134;-0.021128737789688038784 0.036089141208476144262 -2.0825235603553347019 0.27367014803220440777 -2.55040964291837291 -4.1921123636332611184;-0.91586015815191901268 0.40649169516417249515 1.9429980131495765416 0.30404574338231310504 -0.36971642030317031224 0.5664975266489622463;0.050926390616157030111 0.62260168466543330812 0.29499408834359513998 1.7840936697530609401 -6.0942509994105549254 1.5159966475007842224;-1.6683199327660931388 0.27115720654887398577 -0.18489551767617540268 3.0226801425568199377 -4.6195658542625173126 0.29464272083271231262;2.3579355843390157332 1.0574225317516323663 -0.93704172357855741726 2.5715517678733017526 -10.236130180928123323 0.0032261433138610099911;-0.097342549498975763922 0.31645024156552870043 -0.97491840200279111794 0.48892501766760332327 -1.657434114823279625 -1.6267288918895388417;0.31791622315553985656 0.058883204820115463141 -1.7154027541429115455 -2.9861454028233835878 -0.46489347584708329286 2.2343935525434193146;-0.86546087250515690847 0.39572217484377175678 2.0197473774927643397 0.018273494999585741805 -0.69710356398718842375 -0.18204052536446585497;0.026374850483745368446 0.02306023369151736363 0.60707757931140160501 -0.018622719743135344311 0.073623571225122946826 -0.98847137802242235338;-1.148414285895332565 2.1123576413070361824 -1.6766584377784479187 -1.3174997599447597629 -10.43815569207590066 3.6530866333125286971;0.18838551676979684024 -0.10795725429603815482 -0.82866139633405144771 -6.0001269663169276569 -3.5001662221058085223 -0.63983418931873370372];

% Layer 2
b2 = [2.2313604383345766458;-2.3606570237498845088;2.9897733105485508887;5.2007354349739314259;-80.089836634193261489];
LW2_1 = [-3.2251131071024548014 0.94787997479361152386 1.2321533194572094061 -21.791597930156022755 -2.2958154131297430212 -10.21772949885458992 -19.29484045346011456 -2.1894229407914074237 -0.1441350005844170834 -4.1758389737765586602 5.5096854965552770622 10.642048029535770226 -7.8122666866561427668 -1.987956950761315067 -8.3991496598899857418;3.9808459721240665452 -4.0043109577886442096 -0.067930940392688252127 2.103009206587843849 -0.54455036646926524568 0.16344381426386120348 4.138977516192178463 -4.3627119945606018803 -0.96960269662225984089 1.1915091947357134838 -1.8028962386958402586 -1.3893892275660617575 2.8685788612253442231 -0.72122740693270737111 -3.2632933111479829336;1.1036056518733474707 -3.4053594069067916195 0.53330861371708049301 -2.5579656775548214043 -0.51371181001573407165 -2.3679662585322112101 -2.3233565239107747402 -3.051002613390693341 0.039347065826498037189 -1.3210819376784592727 -1.9545841064636542139 2.3108541670014641767 -3.8950720515917511833 -0.10566481024142508616 1.6595064577808769091;-2.2780663258237274782 -29.833643867313924147 2.2163958877358957977 -8.1274724653496335236 2.3548503664451980733 -5.5334044482267810139 -7.4708591021514978436 -26.929011440292185853 -0.12023599360256873037 -4.8118274375606784332 4.6447852252125771955 5.1948830459898243106 7.2311662628196806679 -0.75283201151281620156 8.5924854392312575158;-16.050383290075409093 11.326762397058306675 -8.4009070411247250831 0.32081783451236722815 3.4084582860216885436 -71.656314662828847872 37.078608713671549424 3.6045928187254636654 -10.468659102996360488 20.687072188163000419 27.376870231444161874 -34.538650291880628629 20.068873977024512811 -32.025672101325213248 18.191994399678709016];

% Layer 3
b3 = -0.208325180879087829;
LW3_2 = [-0.054513718094594071362 0.13142507417282894844 -0.77029246215572555467 0.16243518591652308936 -0.026715193701799307829];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0553271360105305;
y1_step1.xoffset = -0.497560739517212;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
