function [Y,Xf,Af] = TRACE_Preformed_TA_1_Atl_1(X,~,~)
%TRACE_PREFORMED_TA_1_ATL_1 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:40.
% 
% [Y] = TRACE_Preformed_TA_1_Atl_1(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999961923064171;-0.999961923064171;-39.5;0;30.0316562652588;-2.96613502502441];
x1_step1.gain = [1.00003807838574;1.00003807838574;0.0155038759689922;0.000363636363636364;0.207805673664695;0.0607333297500273];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.39977245702341629441;0.37224002063799216389;-0.36798392346939817754;-0.98855625421060167035;-2.495649331742294752;-0.96865726886283387564;-0.71082172361981121878;-0.8504222071877146627;1.5116838777200269917;-1.1644705561085537671;-1.6745969127379667363;-0.73948663639888689847;-2.3265385165265723977;2.6327085482605023792;0.025497428707283553706;-1.7383591971462923897;-2.2562702703864672138;-0.74041264646013837947;0.8633894361055496347;0.055569534608561295397];
IW1_1 = [-1.001194995867169979 1.1381166763518344442 0.42422194637717891563 0.11039437956073140656 -1.6592950509723922714 1.0817001530677814447;-0.80324721404585941453 -0.67891467730992083318 -0.40811142284577661687 0.084027149354167079975 2.0659976677238582887 -0.3368993155732439293;0.64493816069104037414 -0.8374614525158065037 -0.18200993205308649281 0.25767848518660152468 0.30404147942830372919 -0.91678524340119071923;-0.71544144486275085271 0.62334266235101765119 -0.57019897824253007457 0.63116387975393895005 -3.8285778307686211264 -0.19007517458541242639;0.72544473717530433277 -3.019887254303755153 1.0491976971618399705 3.6827115369053120553 4.0364118072723398356 -1.5496881936550506165;0.057200360814145083388 0.47273832268374027521 2.6088710980263081218 0.05969805658095806572 3.2064729209859965664 0.67580913971376932459;0.94932975252152818069 -1.1229860277592702555 -0.064792032525793602504 0.0077319729397087935685 0.30516573071372726789 -1.1447542074237733178;-0.68964163838174075138 -1.392623366553979336 -1.0145954145828868231 -0.23164242076348934285 10.02953800491076386 -3.9641709788626640076;-1.2329881821522685748 1.5891447769968118919 0.19269687270665686318 -0.46798012394484655996 1.4537303387807580801 0.27020332506576949516;0.97858988463482488029 -1.299910228639119314 -0.52697514061374617356 0.32836500373139992925 1.1300390367064199193 -1.7348916086697618866;3.0341358861869087704 1.091707398893715375 0.1652661575940706784 -0.13727665826461879495 -3.0977400787441147223 3.1488149562357055089;-0.67903538829084586492 -0.62162527696516933773 -0.60451910075917347775 -0.18042399716277060517 0.38400557267037888076 -0.44887724345872942466;0.68880228271633303638 -2.9740451417883497776 1.0248420880720683357 3.5832815245392586334 1.4093667120410882099 -1.3991045766343048751;0.063504300599486321333 -1.2285187545741720339 0.49814029137833815142 0.40812500262860557099 -0.91488689598536165892 2.0473123124951193574;-0.049209077633332300172 -0.54921573984017524328 -0.38363635884404573284 -0.042335282144208979949 0.70998934262926560734 0.13334033610676090942;-2.0651700916323281199 1.7625370683918633041 -1.7063723446933909411 0.0067566044897974485151 0.29315609775461004549 -0.54969862108621858621;0.23505320987764896645 -1.5608572470432238166 -0.20117871507036957923 -0.7058747680696442206 -0.9628489078457656003 0.82983675328893191647;-0.36067219132434158446 0.089587329469987084241 1.3998579522712868428 -0.42477425567088694658 -0.91793625831496283851 0.6967791816919892689;0.40739603476818120331 0.58110956459094964544 -0.70711721158591955838 -0.26615231836767039297 1.9855572933827054793 0.13016015969556546383;0.65910598208518700325 -0.84558544720711725784 -0.29489819277147372167 0.27788622057220335737 0.79145739665761627446 -0.70976086167211938083];

% Layer 2
b2 = -0.77364268048570350444;
LW2_1 = [1.2400787389526755078 0.52153150738570797085 -5.8463874543227856151 0.20871860393073479734 0.2212075271636485263 -0.073802705856580927413 1.7944532027237414251 -0.049233320120396426023 -0.39635869905338660946 0.7657747637586702627 -0.051350006607509414425 0.28291808193142653494 -0.23665371528865716821 -0.22954225504663347546 -1.1872817103177621956 -0.22613649239466948604 -0.38375185371590997407 0.24560477958120652264 0.26517191076534857297 4.7582391263511736312];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00331170470525242;
y1_step1.xoffset = 2032.08581542969;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
