function [Y,Xf,Af] = TRACE_Preformed_O_1_Other_3(X,~,~)
%TRACE_PREFORMED_O_1_OTHER_3 neural network simulation function.
%
% Auto-generated by MATLAB, 21-Aug-2024 10:13:38.
% 
% [Y] = TRACE_Preformed_O_1_Other_3(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 6xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999961923064171;-0.999961923064171;-77.5;0;30.1649227142334;-2.9811577796936];
x1_step1.gain = [1.00003807838574;1.00003807838574;0.0119760479041916;0.000363636363636364;0.22152510192902;0.0532708976942295];
x1_step1.ymin = -1;

% Layer 1
b1 = [25.693931548236019324;3.2168935621601244534;-3.1761107609922887285;0.81339436711877555197;5.4328348399565147275;0.58972642942781705599;-0.64458397010275025885;2.4282515007296017195;1.6771023523425785395;-2.5393881350452702783;-2.624913246462639016;0.44361943567842582192;-2.7696865628890816602;0.92040747662770594495;17.068202826621465817];
IW1_1 = [0.0092964274001797915503 -0.084831794075288805002 -0.54584400685130474162 24.808986432730172567 -0.086017974501239047314 0.10341152743500878208;0.13872607517510945896 -0.0030987774228184985711 0.58993782015880580349 -0.21785785523979528389 -1.7681975362169064514 3.5484473454235665457;0.12965386296901007523 0.39052694039809682236 1.1556581424923986212 -0.96070920304387308342 0.09302161475389641998 -2.0248974091934486275;-0.11429541463577021221 0.042944744347269178664 0.4117611009400444777 1.4970374518971290012 0.73891879112928549045 -1.9783972594969738701;-2.0710323390869467275 1.5024323607256966362 0.64432780185739246814 0.12554156701957069897 -1.8610785464242796117 1.0657796230933693771;0.62541549944007568396 -0.36247757306653732856 -1.4274562947109501465 -0.48887272927041280912 -0.99221071575313812829 2.1085516651715523473;0.10461121467095876869 -0.036944586856435555899 -0.45254244009520239178 -1.320306395936947208 -0.8005926621437696733 2.1411557184514942165;3.2428119005963562671 -0.21785572063895686235 0.97578683623740902764 1.81695685275994534 1.7109778530643242611 -1.1899784059979563455;0.053086673303594636431 -0.095490139500944676287 -1.167370892463298615 1.5305723554865862113 0.060606434968418991527 0.1202312242725922381;1.1352005281788180024 1.4503207034333029934 -1.9762517909327295129 -0.29538870340564088446 5.0223426623384144207 -0.59997119174204116554;-0.12832306482248836965 0.014665050904505330664 -0.58712399584765695426 0.19995389460853643659 2.5003870533788687958 -2.9497162588127472382;-0.98919137030659642917 -0.5438556473952977921 -1.5996488772023400582 1.0147253462958436554 0.59839474763001687663 2.0325428996487451272;-0.16168785046314637643 0.57315776485906089199 0.66853027104236106837 -0.19833486552943921377 1.5572343886460171536 0.15205493745588882781;0.69815456801376218898 0.32866570407231615603 2.0543525202209966807 -0.32577111912836137497 0.81826153429189552035 -0.17415004719642016018;0.83768659212792728752 -0.55209112990146280708 -0.80572713902931847318 14.146804778566279381 -3.2415233097103510751 3.1929535845184253695];

% Layer 2
b2 = [-2.5994614206488511066;-6.4910168166991057959;-1.0727475817692939675;0.1043811356195104012;0.37587371714589479232];
LW2_1 = [-11.204277488505063332 6.125646835490297093 -0.0062882939165493220365 -5.0094089572156077494 6.690885589719998805 0.23982424659619633323 -4.8608964477398375337 0.14969075254385172391 1.222549195721092552 0.021550666920390790932 7.0074824931138133266 -0.21899385876121027494 -7.8619697639686805246 -0.27787389216566138472 -0.43551295517965094017;0.79897962462792659899 5.9500490335865343638 0.13032724969484832389 7.4056476525807486411 2.5510655674562001671 0.36030937759539655163 7.0515525017936573349 -0.12552228003848536764 -1.1112516236958667193 -0.27792003582536389805 6.6322076458008334399 0.21392877417795388983 -2.254139899572575878 0.65520083267592765797 1.0036045109156375155;3.586461411440975855 3.1582965274352123863 -0.031387461737530944483 3.7020562335109774565 -1.5541821916792148972 0.032246212427729695205 3.4410632974279353746 -0.040928077749077536318 -1.6355687010811854609 0.069457577449871618636 3.2414502735387125121 0.3409666008505884971 0.45241764188928873525 0.28394438734130877933 0.67187727995766588496;-3.4886468092189333312 -2.4638858824128080371 0.047539952648668754032 -4.6481279924863398989 0.57231197171311010141 -0.16404017621022232154 -4.2253818438423387249 0.08780048064483411685 1.4645389458764528356 0.0037201144905954787977 -2.5511457484368795789 -0.33854111680177056964 -2.5870091649450750459 -0.37451216719984531389 -0.71160277751767653243;3.2040450768999440001 1.9586734282547155761 -0.070043783402688852835 5.4000990951479828084 0.3794943471896423115 0.26679875986649531638 4.8919678043766143816 -0.1207116284990914501 -1.2635904013778218591 -0.075141092323775401929 2.0797962697647092156 0.31243425164240445913 3.9900550109017616229 0.44114265427092919092 0.69444604126913578312];

% Layer 3
b3 = 0.59429306940373749502;
LW3_2 = [-0.69737976889573183303 1.6317309546276763665 -19.599359956128640903 -42.463543605589315177 -25.538743446204094312];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.00612908122568115;
y1_step1.xoffset = 89.6956371703064;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = repmat(b3,1,Q) + LW3_2*a2;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a3,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(3,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
